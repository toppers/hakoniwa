<!doctype html><html lang=ja><head><meta name=generator content="Hugo 0.101.0"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>単体ロボット向けシミュレータ使用手順(V850版)</title><meta name=author content="TOPPERS Project Hakoniwa WG"><meta property="og:title" content="単体ロボット向けシミュレータ使用手順(V850版)"><meta property="og:description" content="単体ロボット向けシミュレータ使用手順 V2.1での変更点について v2.1 で，Unityでのシミュレーション実行をビルドしてバイナリ実行できるようになりました．
バイナリ実行でシミュレーション実行を行う場合，
Unityシミュレーションの実行， athrillの実行 をひとまとめにして実行することができます．
なお，従来の使用方法でもシミュレーションを実行することは可能ですので，
その場合は下記をご参照いただき，使用してください．
V850版 ARM版 これ以降は，バイナリ実行を行うための手順の紹介となります．
使用手順 ビルド設定 ビルドの実行，config.jsonの配置 シミュレーションの実行 ビルド設定 ビルドを実施する前に，バイナリ実行時のウィンドウサイズに関する設定を行います．
Unity のメニューから，「Edit」⇒「Project Settings」を選択します．
「Player」
Resolution and PresentationのFullscreen Mode をWindowedと設定します． その下の詳細なウィンドウサイズは基本そのままでもよいですが，サイズを変更したい場合は，
お使いの環境に合わせて変更してください．
ビルドの実行，config.jsonの配置 設定が完了したら，Unityプロジェクトのビルドを行います．
Unity のメニューから，「File」⇒「Build Settings」を選択します．
Platform は[PC,Mac & Linux Standalone]のままとします．
Architectureは実行するPCのアーキテクチャに合わせて設定しますが，
どちらか分からないという方は，x86_64を選択してください．
設定を終えたら，Buildを押下してビルドを実行します．
すると，どの場所にビルドしたバイナリを配置するか，選択ダイアログが表示されますので， 任意の場所を選択します．
今回は例として，ビルドするUnityプロジェクトのあるフォルダ内に，Buildフォルダを作成し，
その中にビルドしたバイナリを配置するようにします．
フォルダを選択すると，ビルドが実行されます．
ビルドが完了したら，バイナリが出力されたフォルダ(今回の例ではBuildフォルダ)内に
先ほど，Unityプロジェクトフォルダ配下に配置したconfig.jsonをコピーします．
制御アプリのビルド シミュレーションの実行の前に制御アプリのビルドを行います．
ビルド手順は，以下のEV3ロボット制御プログラムのビルドをご参照ください．
V850版 ARM版 memory_mmap.txtの編集(通信方式にMMAPを使用する場合のみ) 制御アプリのビルドが完了したら，Unityバイナリ実行のためにアプリケーションフォルダにある
memory_mmap.txtを編集します．
使用するMMAPファイルのパスを記述するのですが，Unityバイナリを使用する場合には，
MMAPファイルのパスを絶対パスで記述するように変更します．
例：アプリケーション名がline_tarceの場合のmemory_mmap.txt
ROM, 0x00000000, 512RAM, 0x00200000, 512RAM, 0x05FF7000, 10240RAM, 0x07FF7000, 10240MMAP, 0x40000000, /mnt/c/project/hakoniwa/ev3rt-athrill-v850e2m/sdk/workspace/line_trace/athrill_mmap."><meta property="og:type" content="article"><meta property="og:url" content="https://toppers.github.io/hakoniwa/single-robot-usage/01_usage_v2.1/"><meta property="og:image" content="https://toppers.github.io/hakoniwa/img/hakoniwa/icon-310x310.png"><meta property="article:section" content="single-robot-usage"><meta name=twitter:card content="summary"><meta name=twitter:site content="@toppersjp"><meta property="fb:app_id" content="3035581286538848"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-169187702-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script>
<link rel=canonical href=https://toppers.github.io/hakoniwa/single-robot-usage/01_usage_v2.1/><link rel=icon type=image/png href=/img/hakoniwa/favicon-32x32.png><link href=/css/font.css rel=stylesheet type=text/css><link href=/css/kube.min.css rel=stylesheet type=text/css><link href=/css/kube.legenda.css rel=stylesheet type=text/css><link href=/css/highlight.css rel=stylesheet type=text/css><link href=/css/main.css rel=stylesheet type=text/css><link href=/css/custom.css rel=stylesheet type=text/css><script src=/js/jquery-2.1.4.min.js type=text/javascript></script><script type=text/javascript src=/js/tocbot.min.js></script></head><body class=page-kube><header><div class=show-sm><div id=nav-toggle-box><div id=nav-toggle-brand><a href=/>箱庭</a></div><a data-component=toggleme data-target=#top href=# id=nav-toggle><i class=kube-menu></i></a></div></div><div class=hide-sm id=top><div id=top-brand><a href=/ title=home><img src=/img/hakoniwa/icon-70x70.png></a></div><nav id=top-nav-main><ul><li><a href=/hakoniwa/docs/>箱庭とは</a></li><li><a href=/hakoniwa/prototypes/>プロトタイプモデル</a></li><li><a href=/hakoniwa/technical-links/>技術情報</a></li><li><a href=/hakoniwa/showcase/>ショーケース</a></li><li><a href=/hakoniwa/getting-started/>Getting Started</a></li><li><a href=/hakoniwa/repositories/>リポジトリ</a></li><li><a href=/hakoniwa/contact/>SNS・問合せ先</a></li></ul></nav><nav id=top-nav-extra><ul><li><a href=# class="active language">Japanese</a></li></ul></nav></div></header><main><div id=main><div id=hero><h1>単体ロボット向けシミュレータ使用手順(V850版)</h1><p class=hero-lead>.</p></div><div id=kube-component class=content><h1 id=単体ロボット向けシミュレータ使用手順>単体ロボット向けシミュレータ使用手順</h1><h2 id=v21での変更点について>V2.1での変更点について</h2><p>v2.1 で，Unityでのシミュレーション実行をビルドしてバイナリ実行できるようになりました．<br>バイナリ実行でシミュレーション実行を行う場合，</p><ul><li>Unityシミュレーションの実行，</li><li>athrillの実行</li></ul><p>をひとまとめにして実行することができます．</p><p>なお，従来の使用方法でもシミュレーションを実行することは可能ですので，<br>その場合は下記をご参照いただき，使用してください．</p><ul><li><a href=https://toppers.github.io/hakoniwa/single-robot-usage/01_usage_v850_v2.0/>V850版</a></li><li><a href=https://toppers.github.io/hakoniwa/single-robot-usage/01_usage_arm_v2.0/>ARM版</a></li></ul><p>これ以降は，バイナリ実行を行うための手順の紹介となります．</p><h2 id=使用手順>使用手順</h2><ol><li>ビルド設定</li><li>ビルドの実行，config.jsonの配置</li><li>シミュレーションの実行</li></ol><h2 id=ビルド設定>ビルド設定</h2><hr><p>ビルドを実施する前に，バイナリ実行時のウィンドウサイズに関する設定を行います．<br>Unity のメニューから，「Edit」⇒「Project Settings」を選択します．</p><p>「Player」<br><code>Resolution and Presentation</code>の<code>Fullscreen Mode</code> を<code>Windowed</code>と設定します．
その下の詳細なウィンドウサイズは基本そのままでもよいですが，サイズを変更したい場合は，<br>お使いの環境に合わせて変更してください．</p><figure><img src=/img/single-robot/unity_build_setting.png border width=600></figure><h2 id=ビルドの実行configjsonの配置>ビルドの実行，config.jsonの配置</h2><hr><p>設定が完了したら，Unityプロジェクトのビルドを行います．<br>Unity のメニューから，「File」⇒「Build Settings」を選択します．</p><p>Platform は[PC,Mac & Linux Standalone]のままとします．<br><code>Architecture</code>は実行するPCのアーキテクチャに合わせて設定しますが，<br>どちらか分からないという方は，<code>x86_64</code>を選択してください．</p><figure><img src=/img/single-robot/unity_build_platform_setting.png border width=600></figure><p>設定を終えたら，<code>Build</code>を押下してビルドを実行します．</p><figure><img src=/img/single-robot/unity_build.png border width=400></figure><p>すると，どの場所にビルドしたバイナリを配置するか，選択ダイアログが表示されますので，
任意の場所を選択します．<br>今回は例として，ビルドするUnityプロジェクトのあるフォルダ内に，<code>Build</code>フォルダを作成し，<br>その中にビルドしたバイナリを配置するようにします．</p><figure><img src=/img/single-robot/unity_build_import.png border width=400></figure><p>フォルダを選択すると，ビルドが実行されます．</p><hr><p>ビルドが完了したら，バイナリが出力されたフォルダ(今回の例では<code>Build</code>フォルダ)内に<br>先ほど，Unityプロジェクトフォルダ配下に配置した<strong>config.json</strong>をコピーします．</p><h2 id=制御アプリのビルド>制御アプリのビルド</h2><hr><p>シミュレーションの実行の前に制御アプリのビルドを行います．<br>ビルド手順は，以下の<code>EV3ロボット制御プログラムのビルド</code>をご参照ください．</p><ul><li><a href=https://toppers.github.io/hakoniwa/single-robot-usage/01_usage_v850_v2.0/>V850版</a></li><li><a href=https://toppers.github.io/hakoniwa/single-robot-usage/01_usage_arm_v2.0/>ARM版</a></li></ul><h3 id=memory_mmaptxtの編集通信方式にmmapを使用する場合のみ>memory_mmap.txtの編集(通信方式にMMAPを使用する場合のみ)</h3><hr><p>制御アプリのビルドが完了したら，Unityバイナリ実行のためにアプリケーションフォルダにある<br><code>memory_mmap.txt</code>を編集します．<br>使用するMMAPファイルのパスを記述するのですが，Unityバイナリを使用する場合には，<br>MMAPファイルのパスを<strong>絶対パス</strong>で記述するように変更します．</p><p><strong>例：アプリケーション名が<code>line_tarce</code>の場合のmemory_mmap.txt</strong></p><pre tabindex=0><code>ROM, 0x00000000, 512
RAM, 0x00200000, 512
RAM, 0x05FF7000, 10240
RAM, 0x07FF7000, 10240
MMAP, 0x40000000, /mnt/c/project/hakoniwa/ev3rt-athrill-v850e2m/sdk/workspace/line_trace/athrill_mmap.bin
MMAP, 0x40010000, /mnt/c/project/hakoniwa/ev3rt-athrill-v850e2m/sdk/workspace/line_trace/unity_mmap.bin
</code></pre><h2 id=シミュレーションの実行>シミュレーションの実行</h2><hr><p>ビルドが完了したら，シミュレーションを実行します．<br>先ほど選択したフォルダにビルドしたバイナリが作成されていますので，
<code>&lt;プロジェクト名>.exe</code>または<code>&lt;プロジェクト名>.app</code>のファイルを実行することでシミュレータが起動します．</p><figure><img src=/img/single-robot/unity_binary_start.png border width=400></figure><p>起動した画面上で<code>実行</code>ボタンを押下すれば，シミュレーションが実行されます．</p><figure><img src=/img/single-robot/unity_binary_sim_start.png border width=600></figure></div></div></main><footer><footer id=footer><nav><ul><li><span>HAKONIWA-WG</span></li></ul></nav><p>&copy; 2019- by Hakoniwa Working-Group, TOPPERS Project</p></footer></footer><script src=/js/kube.js type=text/javascript></script><script src=/js/kube.legenda.js type=text/javascript></script><script src=/js/main.js type=text/javascript></script></body></html>